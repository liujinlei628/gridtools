#{extends 'main.html' /}
#{set title:'index.html' /}

<div class="row">
    <div class="col-lg-12">
        <div class="ibox float-e-margins" id="_qunee">
            <div class="ibox-content" style="overflow: hidden;">
                <h2>${busName} 发现：<span class="text-navy">“${busNodeList.size()}”</span>个子业务</h2>
                <br/>
                <table width="100%" class="table table-striped table-bordered table-hover">
                    <thead>
                        <tr>
                            <th width="10%">序号</th>
                            <th width="10%">业务编号</th>
                            <th width="15%">业务名称</th>
                            <th width="15%">业务内容</th>
                            <th width="20%">业务内容描述</th>
                            <th width="10%">所属板块</th>
                            <th width="10%">专业</th>
                            <th width="10%">操作</th>
                        </tr>
                    </thead>
                    <tbody>
                            #{list items:busNodeList,as:'_busi'}
                            <tr>
                                <td>${_busi_index}</td>
                                <td>${_busi.business}</td>
                                <td>${_busi.name}</td>
                                <td>
                                    ${_busi.content.length() > 9 ? _busi.content[0..9] + '…' : _busi.content}
                                </td>
                                <td>
                                    ${_busi.title.length() > 9 ? _busi.title[0..9] + '…' : _busi.title}
                                </td>
                                <td>${_busi.area}</td>
                                <td>${_busi.major}</td>
                                <td>
                                    <a href="javascript:void(0);" onclick="toDetailInfo('${_busi.id}')" >查看</a>
                                </td>
                            </tr>
                            #{/list}
                        </tbody>
                </table>
                
                <!-- #{list items:busNodeList,as:'_busi'}
                <div class="col-xs-6 col-sm-6 col-md-4 col-lg-3">
                    <a href="@{Summary.show(_busi.id)}">
                    <a href="javascript:void(0);" onclick="toDetailInfo('${_busi.id}')" >
                        <div class="widget navy-bg p-xs text-center">
                            <div class="m-b-md">
                                <h1 class="m-xs">${_busi.business}</h1>
                                <h5 class="font-bold no-margins">
                                    ${_busi.content}
                                </h5>
                                <small>${_busi.content} / ${_busi.description}</small>
                            </div>
                        </div>
                    </a>
                    <div id="${_busi.business}" style="height: 300px; display: none;">${_busi.business}</div>
                </div>
                #{/list} -->
            </div>
        </div>
    </div>
</div>
#{set 'moreScripts'}
<script type="text/javascript" src="@{'/public/js/echarts.min.js'}"></script>
<script type="text/javascript" src="@{'/public/js/jquery-form.min.js'}"></script>
<script type="text/javascript" src="@{'/public/js/jquery.validate.min.js'}"></script>
<script type="text/javascript" src="@{'/public/js/plugins/jquery-ui/jquery-ui.min.js'}"></script>
<link href="@{'/public/js/plugins/jquery-ui/jquery-ui.min.css'}" rel="stylesheet">
<script type="text/javascript">

    function toDetailInfo(nodeId){
        var html = "<div id='dialog-window' title='业务信息'><iframe id='myFrame' src='/Summary/detail?id="+nodeId+"' frameBorder='0' style='border: 0;margin-bottom:-5px;margin-top:-3px;' scrolling='no' height='100%' width='100%'></iframe></div>";
        $(html).dialog($.extend({
            modal: true,
            width: 800,
            height: 500,
            closeOnEscape: false,
            draggable: true,
            resizable: false,
            'class': 'overflow-y:hidden',
            close: function(event, ui) {
              $(this).dialog("destroy"); 
            },
            buttons : [{
                html : "关闭",
                'class' : "btn btn-default btn-sm",
                click : function() {
                    $(this).dialog("close");
                }
            }]
        }));
    }
    
    $(".size").each(function() {
        var maxwidth = 150;
        if ($(this).text().length > maxwidth) {
            $(this).text($(this).text().substring(0, maxwidth));
            $(this).html($(this).html() + '…');
        }
    });
    
</script>
<style type="text/css">
.navy-bg, .bg-primary {
    background-color: #1891d2;
    color: #ffffff;
}

.p-xs {
    height: 220px;
}
</style>
#{/set}
